<div class="container my-5">

  <div *ngIf="infoArtista() as artista; else cargando">
    <div class="card bg-dark text-white border-0 shadow-lg mb-5 overflow-hidden rounded-4">
      <div class="row g-0 align-items-center p-4 p-lg-5">
        <div class="col-md-4 col-lg-3 text-center mb-3 mb-md-0">
          <img [src]="artista.picture_big || artista.picture_medium"
               class="img-fluid rounded-circle shadow border border-4 border-primary"
               style="max-width: 220px;"
               [alt]="artista.name">
        </div>

        <div class="col-md-8 col-lg-9 text-center text-md-start">
          <h5 class="text-uppercase text-primary fw-bold mb-2">Artista Verificado</h5>
          <h1 class="display-3 fw-bold mb-3">{{ artista.name }}</h1>

          @if (!esFavorito) {
                <p>A√±adir a favoritos</p>
          <button (click)="toggleFavorito()" class="btn btn-outline-success m-3">A√±adir a Favoritos</button>
          }

          <div class="d-flex align-items-center justify-content-center justify-content-md-start gap-3">
            <span class="badge bg-secondary fs-6 px-3 py-2 rounded-pill">
              <i class="bi bi-people-fill me-1"></i> {{ artista.nb_fan | number }} Fans
            </span>
            <span class="badge bg-secondary fs-6 px-3 py-2 rounded-pill">
              <i class="bi bi-disc-fill me-1"></i> {{ artista.nb_album }} √Ålbumes
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-template #cargando>
    <div class="alert alert-light text-center py-5 shadow-sm">
      <div class="spinner-border text-primary" role="status"></div>
      <p class="mt-2 text-muted">Cargando perfil del artista...</p>
    </div>
  </ng-template>

  <div class="row g-5">
    <div class="col-lg-6">
      <h3 class="fw-bold mb-4 border-start border-4 border-primary ps-3">üî• Top Canciones</h3>

      <div *ngIf="infoTopCanciones() && infoTopCanciones().length > 0; else noCanciones">
        <div class="list-group list-group-flush shadow-sm rounded-4 overflow-hidden">
          <div class="list-group-item list-group-item-action d-flex align-items-center p-3 border-bottom"
               *ngFor="let cancion of infoTopCanciones(); let i = index">

            <span class="fw-bold text-muted me-3 fs-5" style="width: 20px;">{{ i + 1 }}</span>

            <img [src]="cancion?.album?.cover_small" class="rounded me-3 shadow-sm" width="50" height="50">

            <div class="flex-grow-1 overflow-hidden">
              <h6 class="mb-0 fw-bold text-truncate">{{ cancion?.title }}</h6>
              <small class="text-muted">{{ cancion?.duration }} seg</small>
            </div>

            <audio *ngIf="cancion?.preview" controls [src]="cancion?.preview" class="ms-2"
                   style="height: 30px; max-width: 100px;"></audio>
          </div>
        </div>
      </div>

      <ng-template #noCanciones>
        <p class="text-muted">No hay canciones destacadas disponibles.</p>
      </ng-template>
    </div>

    <div class="col-lg-6">
      <h3 class="fw-bold mb-4 border-start border-4 border-primary ps-3">üíø√Ålbumes</h3>

      <div *ngIf="infoAlbumes() && infoAlbumes().length > 0; else noAlbumes">
        <div class="row row-cols-2 row-cols-md-3 g-3">
          <div class="col" *ngFor="let album of infoAlbumes()">
            <div class="card h-100 border-0 shadow-sm hover-card">
              <div class="position-relative">
                <img [src]="album?.cover_medium" class="card-img-top rounded-top" [alt]="album?.title">
                <div class="card-img-overlay d-flex align-items-end p-0">
                  <span class="badge bg-dark bg-opacity-75 w-100 rounded-0 rounded-bottom py-2">
                    {{ album?.release_date | date:'yyyy' }}
                  </span>
                </div>
              </div>

              <div class="card-body p-2 text-center">
                <small class="fw-bold d-block text-truncate">{{ album?.title }}</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <ng-template #noAlbumes>
        <p class="text-muted">No hay √°lbumes disponibles.</p>
      </ng-template>
    </div>
  </div>
</div>